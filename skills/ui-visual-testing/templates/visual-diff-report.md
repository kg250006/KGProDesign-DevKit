# Visual Regression Report

## Summary

| Field | Value |
|-------|-------|
| **Status** | {PASS \| FAIL} |
| **Total Comparisons** | {total_count} |
| **Passed** | {passed_count} |
| **Failed** | {failed_count} |
| **Threshold** | {threshold}% |
| **Timestamp** | {ISO_timestamp} |

---

## Overall Result: {status_emoji} {PASS / FAIL}

{1-2 sentence summary}

**Passed**: {passed_count}/{total_count} comparisons within {threshold}% threshold

---

## Comparison Results

{For each comparison:}

### {page_name} - {viewport}

| Field | Value |
|-------|-------|
| **Status** | {PASS / FAIL} |
| **Difference** | {percent_different}% ({pixel_count} pixels) |
| **Dimensions** | {width} x {height} |
| **Threshold** | {threshold}% |

#### Files

| Type | Path |
|------|------|
| Baseline | `{baseline_path}` |
| Current | `{current_path}` |
| Diff | `{diff_path}` |

{If FAIL:}
#### Changed Regions

The following areas show significant differences:

- **Region 1**: {description - e.g., "Header area, top 100px"}
- **Region 2**: {description - e.g., "Navigation menu"}
- **Region 3**: {description - e.g., "Footer content"}

#### Diff Preview

![Diff Image]({diff_path})

*Red pixels indicate differences between baseline and current*

---

{End for each}

---

## Failed Comparisons Summary

{If any failures:}

| Page | Viewport | Difference | Status |
|------|----------|------------|--------|
| {page_name} | {viewport} | {percent}% | FAIL |

### Required Actions

For each failed comparison, determine:

1. **Intentional Change** - UI was updated intentionally
   - Action: Update baseline with current screenshot
   - Command: `cp {current_path} {baseline_path}`

2. **Regression Bug** - Unintended visual change
   - Action: Fix the visual regression
   - Create bug ticket with diff image as evidence

{If no failures: "All comparisons passed - no visual regressions detected."}

---

## Baseline Management

### Update Baselines

To accept current screenshots as new baselines:

```bash
# Update single baseline
cp {current_path} {baseline_path}

# Update all baselines from current run
cp -r {current_dir}/* {baseline_dir}/

# With backup
mv {baseline_dir} {baseline_dir}.backup
cp -r {current_dir} {baseline_dir}
```

### Baseline Info

| Page | Last Updated | Viewport |
|------|--------------|----------|
| {page_name} | {last_modified_date} | {viewport} |

---

## Test Configuration

```json
{
  "baselineDir": "{baseline_directory}",
  "currentDir": "{current_directory}",
  "diffDir": "{diff_directory}",
  "threshold": {threshold_percent},
  "viewports": [
    { "name": "desktop", "width": {width}, "height": {height} },
    { "name": "tablet", "width": {width}, "height": {height} },
    { "name": "mobile", "width": {width}, "height": {height} }
  ],
  "ignoreSelectors": [
    "{selector_1}",
    "{selector_2}"
  ]
}
```

---

## Methodology

### Comparison Algorithm

- **Tool**: pixelmatch
- **Color Threshold**: 0.1 (10% color difference tolerance)
- **Anti-aliasing Detection**: Enabled (ignores font rendering differences)
- **Alpha Threshold**: 0.1

### Pre-capture Steps

1. Wait for `networkidle0`
2. Wait for fonts to load
3. Hide dynamic elements: `{list of hidden selectors}`
4. Disable CSS animations
5. 500ms delay for render settling

---

## Troubleshooting

### Common False Positives

| Issue | Cause | Solution |
|-------|-------|----------|
| Font rendering | Different OS/browser | Use web fonts, increase threshold |
| Timestamps | Dynamic content | Hide with ignoreSelectors |
| Animations | Captured mid-animation | Disable animations, add delay |
| Scrollbars | OS-specific styling | Hide scrollbars in test CSS |
| User avatars | Different test users | Use fixed test data |

### Dimension Mismatch

If baseline and current have different dimensions:
- Check viewport settings
- Verify page doesn't have scroll-dependent layout
- Capture element instead of full page

---

## Raw Data

<details>
<summary>Full Comparison Results</summary>

```json
{
  "comparisons": [
    {
      "name": "{page_name}",
      "viewport": "{viewport}",
      "baseline": "{baseline_path}",
      "current": "{current_path}",
      "diff": "{diff_path}",
      "totalPixels": {total_pixel_count},
      "differentPixels": {different_pixel_count},
      "percentDifferent": {percent},
      "threshold": {threshold},
      "passed": {true/false}
    }
  ],
  "summary": {
    "total": {total},
    "passed": {passed},
    "failed": {failed}
  }
}
```

</details>

---

*Report generated by UI Visual Testing Skill*
*Timestamp: {ISO_timestamp}*
